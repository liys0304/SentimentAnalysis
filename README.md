# 基于情感字典的微博话题分析系统
Last update 07,Oct,2024
> 此web基于构建情感词字典，通过清华大学开源中文词法分析工具包thulac进行分词，计算出每段文字的情感得分；
> 构建机器学习模型计算不同立场的评论情感得分阈值。训练数据来源于爬取微博话题中的帖子。
> 通过在前端输入想要分析的微博话题后进行数据统计，使用matplotli将统计数据生成图表后返回~~一个十分简陋的~~前端并且给出分析结果。
> 
模型仅供课程作业以及学习交流使用，不足之处随缘再改。
## 目前的功能：
- 根据话题自动爬取微博上的帖子
- 通过爬取的评论做出近五天的评论立场比例
- 根据五天中的数据走势分析话题的发展趋势
## Start
运行app.py
在浏览器中打开127.0.0.1:5000
输入想要分析的话题后稍作等待（数据爬取速度不是特别快）
## 预览
**~~暂无~~**
## 分词与计算过程
### 构建情感词典
构建了程度副词，否定词，积极情感词和消极情感词，以及标点符号用作分句处理
### 情感得分计算
使用[thulac工具](http://thulac.thunlp.org/)进行分词，
通过对每句话中的情感词前后是否存在否定词以及程度副词来打分。（weigh_sentences.py）
### 情感立场判断
由于使用情感词典进行整句话的判断是比较机械的方式，单纯地通过得分的正负用来判断情感立场在很多时候并不合理，因此在微博的不同话题中爬取了大约300个左右的评论，
打上标签后构建了一个神经网络模型用来计算不同立场的阈值应该是多少（~~能够减少阴阳怪气之类情感词典难以分析的情况）~~
### 数据分析
通过上述模型对抓取的评论（上限为300左右）按天分类进行统计，统计近五天的立场比例以及评论数量，
返回一个柱状图和一个折线图。
### 预测
由于话题的复杂性，并没有采用机器学习的方式对话题趋势进行预测，单纯地使用<font color=red>求导</font>
的方式来判断接下来可能出现的立场变化；并且根据评论数的走势给出热度消减或是上升的分析。
## 不足之处以及注意事项
- 同一个网页进行多个话题的分析时目前还不能及时更新图片
- 前端页面过于简陋
- 没有错误反馈机制，可能导致前端长时间的等待但是后端出错无法返回值
- **特别注意：不能挂代理使用这个web**
- 目前只能反馈近五天的数据，时间过于久远的数据也会爬取下来但不会进行分析，保存在`./topic_tmp`文件夹下
- **<font color=yellow>暂时能想到的就这么多</font>**
## 项目结构
- `./dict`情感词典
- `./static`后端计算生成的图片
- `./topic_tmp`爬取下来的评论数据（可以根据需求在`wb_spider.py`中进行修改），不建议过多，爬虫可能会出错。
- `app.py`
- `classify.py`分类算法，`classify.keras`分类模型
- `cons_dic.py`构建词典预处理脚本
- `sentiment_statistic.py`后端数据分析脚本
- `wb_spider.py` 爬虫
- `weigh_sentences.py`分句，打分

